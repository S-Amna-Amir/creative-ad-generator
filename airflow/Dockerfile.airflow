FROM apache/airflow:2.9.3

# Switch to root only if you need OS packages
USER root

# (Optional) system deps â€” safe to remove if not needed
RUN apt-get update && apt-get install -y \
    build-essential \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# IMPORTANT: switch back to airflow user
USER airflow

# Install Python dependencies as airflow user
RUN pip install --no-cache-dir \
    mlflow \
    pandas \
    scikit-learn
